name: Bash Syntax Check & Lint

on:
  push:
    paths:
      - 'script/**'
      - 'Makefile'
      - '.github/workflows/bash-syntax.yml'

jobs:
  bash-syntax:
    runs-on: ubuntu-latest
    steps:
      - name: Sparse checkout (script/ and Makefile only)
        uses: actions/checkout@v4
        with:
          sparse-checkout: |
            script
            Makefile
      - name: Install shellcheck and shfmt
        run: |
          sudo apt-get update && sudo apt-get install -y shellcheck shfmt
      - name: Run all checks (syntax + lint + format)
        run: |
          make test
