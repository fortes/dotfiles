# vim: ft=sh

# Easy timezones for places I care about
alias lisbon='TZ="Europe/Lisbon" date'
alias miami='TZ="America/New_York" date'
alias nyc='TZ="America/New_York" date'
alias rio='TZ="America/Sao_Paulo" date'
alias seattle='TZ="America/Los_Angeles" date'
alias sf='TZ="America/Los_Angeles" date'
alias utc='date -u'

if command_exists dig; then
  alias myip="dig +short myip.opendns.com @resolver1.opendns.com"
  alias mygeo="curl -w \"\\n\" https://api.hackertarget.com/geoip/\?q=\$(myip)"
fi

# Confirm file overwrite
alias mv='mv -i'

# CD into root of git project via `...`
alias ...="cd \$(git rev-parse --show-toplevel 2>/dev/null || echo '.')"

# Add current project NPM to path
if command_exists npm; then
  alias npath='export PATH=$(npm bin):$PATH'
fi

if command_exists ctop; then
  # Doesn't work well in tmux https://github.com/bcicen/ctop/issues/263
  alias ctop='TERM="${TERM/#tmux/screen}" sudo ~/.local/bin/ctop'
fi

# exa deprecated, eza the fork
eza_name=""
if command_exists exa; then
  eza_name="exa"
elif command_exists eza; then
  eza_name="eza"
fi

if [[ -n "${eza_name:-}" ]]; then
  # Purposefully binding the variable immediately
  # shellcheck disable=SC2139
  alias ls="${eza_name} --group-directories-first --classify"
  # shellcheck disable=SC2139
  alias la="${eza_name} --all --group-directories-first --classify"
  # shellcheck disable=SC2139
  alias ll="${eza_name} --header --git --long --group-directories-first --classify"
  # shellcheck disable=SC2139
  alias ltree="${eza_name} --header --git --long --tree --level=2 --group-directories-first --classify"
else
  # Map ls to be colorful and reasonable defaults
  if uname | grep -q Darwin; then
    alias ls='ls --color=auto -pFhv'
  else
    # --quoting-style not available on Mac
    alias ls='ls --color=auto -pFhv --quoting-style=shell-escape'
  fi
  alias la='ls --color=auto -ApFhv'
  alias ll='ls --color=auto -AlpFhv'
fi

if command_exists imv-wayland; then
  alias imv='imv-wayland'
fi

# Debianisms outside of Debian
if command_exists fd; then
  alias fdfind='fd'
fi
if command_exists bat; then
  alias batcat='bat'
fi
if command_exists eza; then
  alias exa='eza'
fi

if command_exists code; then
  # Override Mac's default storage dir to match Linux
  alias code='code --user-data-dir="${XDG_CONFIG_HOME}/Code"'
fi

# Flatpak aliases
if command_exists flatpak; then
  # Make sure to use config from `~/.config`, not `~/.var/app/xxx`
  alias ncspot='flatpak run io.github.hrkfdn.ncspot --config "${XDG_CONFIG_HOME}/ncspot/config.toml"'
fi

# Load local file if present
if [ -f ~/.aliases.local ]; then
  # shellcheck source=/dev/null
  . ~/.aliases.local
fi
