#!/usr/bin/env bash
#
# Toggle pause state for cmus

set -euo pipefail
IFS=$'\n\t'

main() {
  local local_status
  local verb
  local title
  local albumartist

  if local_status=$(cmus-remote -Q 2> /dev/null); then
    local play_status

    play_status=$(echo "${local_status}" | head -n 1 | cut -d' ' -f2)
    if [[ "${play_status}" == "stopped" ]]; then
      echo "Not playing music"
      exit 1
    elif [[ "${play_status}" == "playing" ]]; then
      verb="Paused"
    else
      verb="Playing"
    fi

    albumartist=$(echo "${local_status}" | grep "tag albumartist" | head -n 1 | cut -d' ' -f3-)
    title=$(echo "${local_status}" | grep "tag title" | head -n 1 | cut -d' ' -f3-)

    cmus-remote -u && echo "$verb: $albumartist - $title"
  else
    echo "cmus not running"
    exit 1
  fi
}

main "${@}"

